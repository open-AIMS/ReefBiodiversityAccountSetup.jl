<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ReefBiodiversityAccountSetup.jl Documentation · ReefBiodiversityAccountSetup Documentation</title><meta name="title" content="ReefBiodiversityAccountSetup.jl Documentation · ReefBiodiversityAccountSetup Documentation"/><meta property="og:title" content="ReefBiodiversityAccountSetup.jl Documentation · ReefBiodiversityAccountSetup Documentation"/><meta property="twitter:title" content="ReefBiodiversityAccountSetup.jl Documentation · ReefBiodiversityAccountSetup Documentation"/><meta name="description" content="Documentation for ReefBiodiversityAccountSetup Documentation."/><meta property="og:description" content="Documentation for ReefBiodiversityAccountSetup Documentation."/><meta property="twitter:description" content="Documentation for ReefBiodiversityAccountSetup Documentation."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>ReefBiodiversityAccountSetup Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>ReefBiodiversityAccountSetup.jl Documentation</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Configuration-file"><span>Configuration file</span></a></li><li><a class="tocitem" href="#Downloading-data"><span>Downloading data</span></a></li><li><a class="tocitem" href="#Exploring-a-dataset"><span>Exploring a dataset</span></a></li><li><a class="tocitem" href="#Deriving-benthic-categories-which-may-support-coral-habitat"><span>Deriving benthic categories which may support coral habitat</span></a></li><li><a class="tocitem" href="#Deriving-other-environmental-variable-maps"><span>Deriving other environmental variable maps</span></a></li><li><a class="tocitem" href="#Selecting-project-and-control-sites"><span>Selecting project and control sites</span></a></li></ul></li><li><a class="tocitem" href="API/">ReefBiodiversityAccountSetup API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>ReefBiodiversityAccountSetup.jl Documentation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>ReefBiodiversityAccountSetup.jl Documentation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/open-AIMS/ReefBiodiversityAccountSetup.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/open-AIMS/ReefBiodiversityAccountSetup.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ReefBiodiversityAccountSetup.jl-Documentation"><a class="docs-heading-anchor" href="#ReefBiodiversityAccountSetup.jl-Documentation">ReefBiodiversityAccountSetup.jl Documentation</a><a id="ReefBiodiversityAccountSetup.jl-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#ReefBiodiversityAccountSetup.jl-Documentation" title="Permalink"></a></h1><ul><li><a href="API/#ReefBiodiversityAccountSetup-API">ReefBiodiversityAccountSetup API</a></li><li class="no-marker"><ul><li><a href="API/#Spatial-Analysis">Spatial Analysis</a></li><li><a href="API/#Plotting">Plotting</a></li></ul></li><li><a href="#ReefBiodiversityAccountSetup.jl-Documentation">ReefBiodiversityAccountSetup.jl Documentation</a></li><li class="no-marker"><ul><li><a href="#Installation">Installation</a></li><li><a href="#Introduction">Introduction</a></li><li><a href="#Configuration-file">Configuration file</a></li><li><a href="#Downloading-data">Downloading data</a></li><li><a href="#Exploring-a-dataset">Exploring a dataset</a></li><li><a href="#Deriving-benthic-categories-which-may-support-coral-habitat">Deriving benthic categories which may support coral habitat</a></li><li><a href="#Deriving-other-environmental-variable-maps">Deriving other environmental variable maps</a></li><li><a href="#Selecting-project-and-control-sites">Selecting project and control sites</a></li></ul></li></ul><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>Download the package using the Julia package installer,</p><pre><code class="language-julia hljs">pkg&gt; add ReefBiodiversityAccountSetup</code></pre><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>ReefBiodiversityAccountSetup supports spatial analysis and visualisation to inform the setup of a Reef Biodiversity Account using open access data layers from the Allen Coral Atlas (<a href="https://www.allencoralatlas.org/">https://www.allencoralatlas.org/</a>) and NOAA databases (<a href="https://coralreefwatch.noaa.gov/satellite/index.php">https://coralreefwatch.noaa.gov/satellite/index.php</a>).</p><h2 id="Configuration-file"><a class="docs-heading-anchor" href="#Configuration-file">Configuration file</a><a id="Configuration-file-1"></a><a class="docs-heading-anchor-permalink" href="#Configuration-file" title="Permalink"></a></h2><p>A &quot;config.toml&quot; file needs to be added to the project root to facilitate access to key data files. The structure of the TOML is as follows:</p><pre><code class="nohighlight hljs">[bathy_data]
allen_bathy = &quot;Path to Allen Atlas bathymetric data as a .tif&quot;
gbrmpa_bathy = &quot;Path to GBRMPA bathymetric data if this is being used (for GBR only)&quot;

[spatial_data]
allen_spatial = &quot;Path to the Allen Atlas region data set (benthic and geomorphic data as gpkgs)&quot;
gbrmpa_region = &quot;If using GBRMPA data for the GBR, the GBRMPA region gpkg path can be added here&quot;

[dhw_data]
noaa_dhw = &quot;Path to NOAA DHW netcdfs&quot;

[other_data]
allen_turbid = &quot;Path to other key Allen Atlas datasets, such as turbidity data&quot;</code></pre><h2 id="Downloading-data"><a class="docs-heading-anchor" href="#Downloading-data">Downloading data</a><a id="Downloading-data-1"></a><a class="docs-heading-anchor-permalink" href="#Downloading-data" title="Permalink"></a></h2><p>To assess a range of reef areas as potential account areas, one of the Allen Atlas region maps can first be downloaded, by selecting a region from the &quot;Mapped/Monitored Areas&quot; tab on the Atlas main page and clicking the download icon:</p><p><img src="assets/imgs/allen_atlas_region_download.png" alt="Allen Atlas regional data download"/></p><p>An account with the Allen Coral Atlas must be made to do this and the downloaded data will be sent via the account&#39;s associated email. This dataset will contain geomorphic and benthic data for a reef region, such as the Great Barrier Reef and Torres Strait.</p><p>To plot some initial maps of the region, the dataset file path should be added to the config file under <code>[spatial data], allen_spatial</code>. To add additional datasets such as bathymetry or turbidity data, an account domain must be selected using the drawing tool:</p><p><img src="assets/imgs/select_domain_example.png" alt="Allen Atlas domain download"/></p><p>Additional downloaded dataset paths should also be added to the <code>config.toml</code> file. The path for bathymetry data should be added under <code>[bathy data], allen_bathy</code>, and any other data paths such as turbidity data can be added under <code>[other_data]</code>.</p><p>Once a domain has been selected, named and saved, various data layers can be selected and downloaded from the &quot;My Areas&quot; tab: <img src="assets/imgs/downloading_domain_files.png" alt="Allen Atlas download domain files"/></p><p>Selected domains can then be saved under a name for future downloads and analysis:</p><p><img src="assets/imgs/name_dataset_example.png" alt="Allen Atlas save domain"/></p><h2 id="Exploring-a-dataset"><a class="docs-heading-anchor" href="#Exploring-a-dataset">Exploring a dataset</a><a id="Exploring-a-dataset-1"></a><a class="docs-heading-anchor-permalink" href="#Exploring-a-dataset" title="Permalink"></a></h2><p>Datasets downloaded from the Allen Atlas can first be explored through visualisations before settling on a project domain. Geomorphic and benthic zone plots may be of interest in assessing available space for coral habitat and habitat suitability for planned management and intervention acitivities.</p><p>Geomorphic and bethic zone data, as well as the reef extent, can be loaded using <code>spatial_analysis.load_spatial_base(config_file)</code>, where <code>config_file</code> is the path to a config file as described in the &quot;Configuration file&quot; section. Make sure any downloaded benthic or geomorphic data is saved as a geopackage:</p><p><img src="assets/imgs/set_as_geopackage.png" alt="Allen Atlas set download as geopackage"/></p><p>Latitudinal and longitudinal limits for the region of interest can be set using <code>spatial_analysis.get_geo_within_box()</code>.</p><pre><code class="language-julia hljs">    import GeoDataFrames as GDF
    using GLMakie, GeoMakie, GraphMakie
    import ReefBiodiversityAccountSetup as RBAS

    config_file = RBAS.spatial_analysis.load_config(; config_path=&quot;../config.toml&quot;)

    benthic, geomorphic, reef_extent = RBAS.spatial_analysis.load_spatial_base(config_file)

    # Set box limits for loading account data
    box_upper = (-16.75284, 146.15641)
    box_lower = (-16.95082, 146.32396)

    # Get benthic and geomorphic data within the account box
    benthic = RBAS.spatial_analysis.get_geo_within_box(benthic, box_upper, box_lower)
    geomorphic = RBAS.spatial_analysis.get_geo_within_box(geomorphic, box_upper, box_lower)
    extent = RBAS.spatial_analysis.get_geo_within_box(reef_extent, box_upper, box_lower)

    # Plot benthic and geomorphic data
    fig_benthic = RBAS.plotting.spatial_map(
        benthic,
        benthic[:, :class];
        opts=Dict(:legend_name =&gt; &quot;Benthic map&quot;,
            :color_map =&gt; :Accent_5)
    )
    fig_geomorphic = RBAS.plotting.spatial_map(
        geomorphic,
        geomorphic[:, :class];
        opts=Dict(:legend_name =&gt; &quot;Geomorphic map&quot;,
            :color_map =&gt; :hawaii10)
    )</code></pre><p><img src="assets/imgs/benthic_example_domain.png" alt="Allen Atlas benthic data"/> <img src="assets/imgs/geomorphic_example_domain.png" alt="Allen Atlas geomorphic data"/></p><h2 id="Deriving-benthic-categories-which-may-support-coral-habitat"><a class="docs-heading-anchor" href="#Deriving-benthic-categories-which-may-support-coral-habitat">Deriving benthic categories which may support coral habitat</a><a id="Deriving-benthic-categories-which-may-support-coral-habitat-1"></a><a class="docs-heading-anchor-permalink" href="#Deriving-benthic-categories-which-may-support-coral-habitat" title="Permalink"></a></h2><p>Estimated area which can support coral can be visualised by filtering the benthic data for the Coral/Algal/Rock categories (the accuracy of this estimation varies, as described in the Allen Atlas documentation included in the data download files). Deriving the intersection of the geomorphic and benthic data polygons using <code>spatial_analysis.multipoly_geom_intersection()</code> can speed up further analysis as this finds a smaller set of polygons of unique benthic/ggeomorphic categories which intersect with the reef extent polygons.</p><p>The following finds the polygons in the Coral/Algal/Rock categories and plots these as a map to show potential reef habitat which may support coral.</p><pre><code class="language-julia hljs">    # Filter for Coral/Algae type
    benthic_filtered = RBAS.spatial_analysis.filter_site_area(benthic)

    # Get intersection of benthic filtered polygons and account extent to reduce number of polygons
    benthic_ext = RBAS.spatial_analysis.multipoly_geom_intersection(
        extent, benthic_filtered, :class
    )

    fig_benthic_filtered = RBAS.plotting.spatial_map(
        benthic_ext,
        benthic_ext[:, :class];
        opts=Dict(:legend_name =&gt; &quot;Coral/Rock substrate&quot;,
            :color_map =&gt; :tab10)
    )</code></pre><p><img src="assets/imgs/benthic_filtered_example_domain.png" alt="Allen Atlas benthic data filtered"/></p><p>This process can also beused to plot the geomorphic categories of areas in the Coral/Algal/Rock categories, allowing visualisation of the key geomorphic categories of reef area which may provide coral habitat.</p><pre><code class="language-julia hljs">    # Get intersection of geomorphic polygons and account extent to reduce the number of polygons
    geomorphic_ext = RBAS.spatial_analysis.multipoly_geom_intersection(
        extent, geomorphic, :class
    )

    # Get intersection of benthic filtered polygons and geomorphic polygons
    geomorphic_benthic_comb = RBAS.spatial_analysis.multipoly_geom_intersection(
        benthic_ext, geomorphic_ext, :class
    )

    fig_geomorphic_ext = RBAS.plotting.spatial_map(
        geomorphic_ext,
        geomorphic_ext[:, :class];
        opts=Dict(:legend_name =&gt; &quot;Geomorphic class&quot;,
            :color_map =&gt; :hawaii10)
    )

    fig_geomorphic_filtered = RBAS.plotting.spatial_map(
        geomorphic_benthic_comb,
        geomorphic_benthic_comb[:, :class];
        opts=Dict(:legend_name =&gt; &quot;Geomorphic categories of Coral/Rock substrate&quot;,
            :color_map =&gt; :hawaii10)
    )
</code></pre><p><img src="assets/imgs/geomorphic_filtered_example_domain.png" alt="Allen Atlas geomorphic data filtered"/></p><h2 id="Deriving-other-environmental-variable-maps"><a class="docs-heading-anchor" href="#Deriving-other-environmental-variable-maps">Deriving other environmental variable maps</a><a id="Deriving-other-environmental-variable-maps-1"></a><a class="docs-heading-anchor-permalink" href="#Deriving-other-environmental-variable-maps" title="Permalink"></a></h2><p>Other environmental variables and their spatial variation can be plotted as zonal statistics across the derived spatial polygons for the area of interest. Median depth, for example, can be derived from the Allen Atlas datasets.</p><pre><code class="language-julia hljs">    # Extract depths from raster file
    geomorphic_filtered, depths = RBAS.spatial_analysis.median_features_allen(
        geomorphic_filtered, config_file; is_depth=true
    )

    # Plot depths
    fig_depth = RBAS.plotting.spatial_map(
        geomorphic_filtered,
        geomorphic_filtered[:, :depth_med];
        opts=Dict(:colorbar_label =&gt; &quot;Median depth&quot;,
            :color_map =&gt; :lighttest)
    )</code></pre><p><img src="assets/imgs/depth_filtered_example_domain.png" alt="Allen Atlas depth"/></p><p>Another key quantity in understanding coral vulnerability to heat stress is Degree Heating Weeks. This information can be derived fromt the NOAA Reef Watch database (<a href="https://coralreefwatch.noaa.gov/satellite/index.php">https://coralreefwatch.noaa.gov/satellite/index.php</a>) and zonally aggregated to visualise broadscale estimates of heat stress.</p><pre><code class="language-julia hljs">    # Extract broadscale NOAA DHWs
    geomorphic_filtered, dhws = RBAS.spatial_analysis.noaa_dhw_means(geomorphic_filtered, config_file)

    # Plot mean and std for dhws
    fig_dhw_mean = RBAS.plotting.spatial_map(
        geomorphic_filtered,
        geomorphic_filtered[:, :dhw_hist_mean];
        opts=Dict(:colorbar_label =&gt; &quot;Mean max dhw&quot;,
            :color_map =&gt; :lighttest)
    )
    fig_dhw_std = RBAS.plotting.spatial_map(
        geomorphic_filtered,
        geomorphic_filtered[:, :dhw_hist_sd];
        opts=Dict(:colorbar_label =&gt; &quot;Std max dhw&quot;,
            :color_map =&gt; :lighttest)
    )
</code></pre><p><img src="assets/imgs/mean_max_dhw_example_domain.png" alt="Allen Atlas dhws filtered"/></p><p>The Allen Atlas datasets can also be downloaded with several key environmental variables, such as turbidity. These can also be zonally aggregated and plotted.</p><pre><code class="language-julia hljs">
    # Allen atlas turbidity data
    turb_fn = config_file[&quot;other_data&quot;][&quot;allen_turbid&quot;]

    # Add turbidity data from Allen Atlas
    geomorphic_filtered, turbidity = RBAS.spatial_analysis.median_features_allen(
        geomorphic_filtered, turb_fn; data_name=:turb_med
    )

    fig_turb_med = RBAS.plotting.spatial_map(
        geomorphic_filtered,
        geomorphic_filtered[:, :turb_med];
        opts=Dict(:colorbar_label =&gt; &quot;Turbidity mean&quot;,
            :color_map =&gt; :lighttest)
    )</code></pre><p><img src="assets/imgs/med_turb_example_domain.png" alt="Allen Atlas turbs filtered"/></p><h2 id="Selecting-project-and-control-sites"><a class="docs-heading-anchor" href="#Selecting-project-and-control-sites">Selecting project and control sites</a><a id="Selecting-project-and-control-sites-1"></a><a class="docs-heading-anchor-permalink" href="#Selecting-project-and-control-sites" title="Permalink"></a></h2><pre><code class="language-julia hljs">    # Plot impact site rating
    impact_site_ratings = RBAS.spatial_analysis.suggest_impact_sites(geomorphic_filtered; sorted=false)

    fig_impact= RBAS.plotting.spatial_map(
        geomorphic_filtered[:, impact_site_rating[:, :Index]],
        impact_site_rating[:, :Rating];
        opts=Dict(:colorbar_label =&gt; &quot;Impact site rating&quot;,
            :color_map =&gt; :lighttest)
    )</code></pre><pre><code class="language-julia hljs">    geomorphic_filtered[!, :ID] = collect(1:size(geomorphic_filtered,1))
    # Suggest control sites for a particular impact site (e.g. 5)
    control_site_ratings = RBAS.spatial_analysis.suggest_control_sites(5, geomorphic_filtered[:,Not(:geom)], [:class]; ID_COLUMN=:ID)

    fig = spatial_map(geomorphic_filtered[:, control_site_rating[:, :Index]],
        control_site_rating[:, :Similarity],
        opts=Dict(:colorbar_label =&gt; &quot;Control site similarity for site 5&quot;, :color_map =&gt; :lightest))
</code></pre></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="API/">ReefBiodiversityAccountSetup API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 26 August 2025 07:26">Tuesday 26 August 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
